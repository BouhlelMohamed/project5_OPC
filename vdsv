//on verifie si le formulaire a été envoyé
	if(isset($_POST['submit'])){
		//la variable erreur vaut null par défaut
		$erreur = null;
		//on convertit chaque champ en variable avec la fonction extract()
		extract($_POST);
		
		//on verifie les champs vides
		if(empty($pseudo) || empty($password)){
			$erreur = '<p class = "alert alert-danger">Veuillez remplir tous les champs</p>';
		}
		
		//on verifie si le pseudo existe déja
		$sql = $cnx->query("SELECT * FROM admins WHERE pseudo = '$pseudo'") or die('Erreur de la requête SQL');
		$total = $sql->rowCount();
		if($total != 1){
			//ce membre n'existe pas
			$erreur = '<p class = "alert">Ce pseudo n\'existe pas dans notre base de données !</p>';
		}
		else{
			/*
				on verifie si le mot de passe est correct
				tout d'abord pour comparer le mot de passe avec celui dans la table 
				il faut le crypter avant en utilisant la fonction md5() 
			*/
			$password = ($password);
			//recuperation des données dans la table de l'utilisateur
			//ca remplace mysql_feetch_array 
			while ($resultat = $sql->fetch()){
				
			if($resultat['password'] !== $password){
				//le mot de passe est incorrect
				$erreur = '<p class = "alert">Votre mot de passe est incorrect !</p>';
			}
			else{
				//tout est bon on enregistre les données de l'utilisateur en session
				$_SESSION['pseudo'] = $pseudo;
				$_SESSION['id'] = $resultat['id'];
				//on le redirige sur la page d'accueil
				header('location:../index.php');
			}
			
		}		
	}




if(!isset($_SESSION['id']) || !isset($_SESSION['pseudo'])){
  //l'utilisateur n'est pas connecté on le redirige sur la page de connexion
  header('location:../cnx/connexion.php');
}

